<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>网页版数学计算器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mathjs@11.9.1/lib/browser/math.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1E3A8A',
                        secondary: '#3B82F6',
                        accent: '#10B981',
                        dark: '#1F2937',
                        light: '#F9FAFB',
                        editor: '#0F172A',
                        output: '#1E293B',
                    },
                    fontFamily: {
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .editor-shadow {
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            }
            .blink-cursor {
                animation: blink 1s step-end infinite;
            }
            @keyframes blink {
                from, to { opacity: 1; }
                50% { opacity: 0; }
            }
            .output-line {
                transition: all 0.2s ease-out;
            }
            .output-line:hover {
                background-color: rgba(255, 255, 255, 0.05);
            }
            .function-card {
                transition: all 0.3s ease;
            }
            .function-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            }
            .reference-item {
                transition: all 0.2s ease;
            }
            .reference-item:hover {
                background-color: rgba(0, 0, 0, 0.03);
                transform: translateX(5px);
            }
            .slider-thumb {
                appearance: none;
                width: 20px;
                height: 20px;
                border-radius: 50%;
                background: #3B82F6;
                cursor: pointer;
                transition: all 0.15s ease;
            }
            .slider-thumb:hover {
                box-shadow: 0 0 0 8px rgba(59, 130, 246, 0.1);
            }
            .quick-input-item {
                transition: all 0.2s ease;
            }
            .quick-input-item:hover {
                background-color: rgba(59, 130, 246, 0.1);
                transform: translateX(2px);
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-light to-blue-50 min-h-screen font-mono text-dark">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- 标题区域 -->
        <header class="text-center mb-6">
            <h1 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary to-secondary mb-2">
                网页版数学计算器
            </h1>
            <p class="text-secondary text-lg">支持复数运算的交互式数学计算环境</p>
        </header>

        <!-- 计算器主体 -->
        <div class="bg-white rounded-2xl overflow-hidden shadow-lg mb-10">
            <!-- 工具栏 -->
            <div class="bg-primary text-white px-4 py-2 flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <div class="w-3 h-3 rounded-full bg-red-500"></div>
                    <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                    <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    <span class="ml-2 text-sm font-medium">数学计算器</span>
                </div>
                <div class="flex space-x-3">
                    <button id="clear-btn" class="text-white hover:text-gray-300 transition-colors">
                        <i class="fa fa-trash-o"></i>
                    </button>
                    <button id="copy-btn" class="text-white hover:text-gray-300 transition-colors">
                        <i class="fa fa-copy"></i>
                    </button>
                    <button id="theme-toggle" class="text-white hover:text-gray-300 transition-colors">
                        <i class="fa fa-moon-o"></i>
                    </button>
                    <button id="help-btn" class="text-white hover:text-gray-300 transition-colors">
                        <i class="fa fa-question-circle"></i>
                    </button>
                </div>
            </div>

            <!-- 精度设置 -->
            <div class="bg-gray-100 p-3 border-b border-gray-200">
                <div class="flex flex-col md:flex-row items-center justify-between">
                    <div class="flex items-center mb-2 md:mb-0">
                        <label for="eps-slider" class="text-sm font-medium mr-3">计算精度 (eps):</label>
                        <input type="range" id="eps-slider" min="1" max="15" value="6" 
                            class="w-40 h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer">
                        <span id="eps-value" class="ml-3 text-sm font-medium">1e-6</span>
                    </div>
                    <div class="text-xs text-gray-500">
                        当前设置: 结果将显示到 <span id="precision-value">6</span> 位小数
                    </div>
                </div>
            </div>

            <!-- 编辑器和输出区域 -->
            <div class="flex flex-col h-[550px]">
                <!-- 输出区域 -->
                <div id="output-area" class="flex-1 bg-output text-white p-4 overflow-y-auto">
                    <div class="output-line">
                        <span class="text-accent">&gt;&gt;&gt;</span> 
                        <span class="ml-2">欢迎使用网页版数学计算器</span>
                    </div>
                    <div class="output-line">
                        <span class="text-accent">&gt;&gt;&gt;</span> 
                        <span class="ml-2">支持基本数学运算、函数、变量和复数运算</span>
                    </div>
                    <div class="output-line">
                        <span class="text-accent">&gt;&gt;&gt;</span> 
                        <span class="ml-2">使用滑块调整计算精度 (eps = 1e-<span id="init-precision">6</span>)</span>
                    </div>
                </div>

                <!-- 输入区域 -->
                <div class="bg-editor text-white p-4 border-t border-gray-700">
                    <div class="flex items-start">
                        <span class="text-accent">&gt;&gt;&gt;</span>
                        <input type="text" id="input-field" class="bg-transparent border-none outline-none ml-2 flex-1 min-h-[24px] text-white font-mono" placeholder="输入数学表达式...">
                    </div>
                </div>
            </div>
        </div>

        <!-- 函数和运算符参考 -->
        <div id="functions-reference" class="bg-white rounded-2xl p-6 md:p-8 calculator-shadow">
            <h2 class="text-xl font-bold text-primary mb-6">函数和运算符参考</h2>
            
            <!-- 运算符 -->
            <div class="mb-8">
                <h3 class="text-lg font-semibold text-secondary mb-4 flex items-center">
                    <i class="fa fa-calculator mr-2"></i> 运算符
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">+</div>
                        <div class="flex-1">
                            <p class="text-sm">加法运算。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: 2+3 或 (2+3i)+(4-5i)</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">-</div>
                        <div class="flex-1">
                            <p class="text-sm">减法运算或取负。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: 5-3 或 -(2+3i)</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">*</div>
                        <div class="flex-1">
                            <p class="text-sm">乘法运算。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: 2*3 或 (2+3i)*(4-5i)</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">/</div>
                        <div class="flex-1">
                            <p class="text-sm">除法运算。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: 6/3 或 (2+3i)/(4-5i)</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">^</div>
                        <div class="flex-1">
                            <p class="text-sm">幂运算。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: 2^3 或 (2+3i)^2</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">=</div>
                        <div class="flex-1">
                            <p class="text-sm">变量赋值。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: a=5 或 z=2+3i</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 基本数学函数 -->
            <div class="mb-8" id="basic-functions">
                <h3 class="text-lg font-semibold text-secondary mb-4 flex items-center">
                    <i class="fa fa-function mr-2"></i> 基本数学函数
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                    <!-- 函数列表将动态生成 -->
                </div>
            </div>
            
            <!-- 复数函数 -->
            <div class="mb-8">
                <h3 class="text-lg font-semibold text-secondary mb-4 flex items-center">
                    <i class="fa fa-complex-number mr-2"></i> 复数函数
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">abs(z)</div>
                        <div class="flex-1">
                            <p class="text-sm">计算复数z的模（绝对值）。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: abs(3+4i) 返回 5</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">conj(z)</div>
                        <div class="flex-1">
                            <p class="text-sm">计算复数z的共轭。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: conj(2+3i) 返回 2-3i</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">arg(z)</div>
                        <div class="flex-1">
                            <p class="text-sm">计算复数z的辐角（主值）。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: arg(1+i) 返回 pi/4</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">re(z)</div>
                        <div class="flex-1">
                            <p class="text-sm">提取复数z的实部。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: re(2+3i) 返回 2</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">im(z)</div>
                        <div class="flex-1">
                            <p class="text-sm">提取复数z的虚部。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: im(2+3i) 返回 3</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">eps</div>
                        <div class="flex-1">
                            <p class="text-sm">当前计算精度（1e-<span id="eps-reference">6</span>）。</p>
                            <p class="text-xs text-gray-500 mt-1">使用滑块调整精度</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 常量 -->
            <div>
                <h3 class="text-lg font-semibold text-secondary mb-4 flex items-center">
                    <i class="fa fa-constant mr-2"></i> 常量
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">pi</div>
                        <div class="flex-1">
                            <p class="text-sm">圆周率，约等于3.141592653589793。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: pi*2 返回约6.2831853</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">e</div>
                        <div class="flex-1">
                            <p class="text-sm">自然常数，约等于2.718281828459045。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: exp(1) 返回 e</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">i</div>
                        <div class="flex-1">
                            <p class="text-sm">虚数单位，定义为√(-1)。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: i*i 返回 -1</p>
                        </div>
                    </div>
                    
                    <div class="reference-item bg-gray-50 p-3 rounded-lg flex items-center">
                        <div class="w-20 font-mono font-bold text-primary">ans</div>
                        <div class="flex-1">
                            <p class="text-sm">存储上一次计算的结果。</p>
                            <p class="text-xs text-gray-500 mt-1">示例: 先计算2+3，然后输入ans*2 返回10</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 自定义变量和函数列表 -->
        <div id="custom-variables-functions" class="bg-white rounded-2xl p-6 md:p-8 calculator-shadow mt-10">
            <h2 class="text-xl font-bold text-primary mb-6">自定义变量和函数</h2>
            <div id="custom-items-list"></div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="mt-12 text-center text-secondary text-sm pb-6">
        <p>© 2025 网页版数学计算器 | 使用现代Web技术构建</p>
    </footer>

    <script src="./js/calculator.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const builtinFunctions = [
                'sin', 'cos', 'tan', 'asin', 'acos', 'atan',
                'log', 'exp', 'sqrt', 'abs', 'factorial',
                'conj', 'arg', 're', 'im', 'pow', 'sinh', 'cosh', 'tanh'
            ];

            const basicFunctionsContainer = document.querySelector('#basic-functions .grid');

            builtinFunctions.forEach(func => {
                const item = document.createElement('div');
                item.className = 'reference-item bg-gray-50 p-3 rounded-lg flex items-center';

                const funcNameDiv = document.createElement('div');
                funcNameDiv.className = 'w-24 font-mono font-bold text-primary'; // 增加宽度以避免重叠
                let funcParams = '';
                switch (func) {
                    case 'pow':
                        funcParams = '(x, y)';
                        break;
                    default:
                        funcParams = '(x)';
                }
                funcNameDiv.textContent = `${func}${funcParams}`;

                const descriptionDiv = document.createElement('div');
                descriptionDiv.className = 'flex-1';

                const descriptionP = document.createElement('p');
                descriptionP.className = 'text-sm';
                switch (func) {
                    case 'sin':
                        descriptionP.textContent = '计算x的正弦值（弧度）。';
                        break;
                    case 'cos':
                        descriptionP.textContent = '计算x的余弦值（弧度）。';
                        break;
                    case 'tan':
                        descriptionP.textContent = '计算x的正切值（弧度）。';
                        break;
                    case 'asin':
                        descriptionP.textContent = '计算x的反正弦值（弧度）。';
                        break;
                    case 'acos':
                        descriptionP.textContent = '计算x的反余弦值（弧度）。';
                        break;
                    case 'atan':
                        descriptionP.textContent = '计算x的反正切值（弧度）。';
                        break;
                    case 'log':
                        descriptionP.textContent = '计算x的自然对数（以e为底）。';
                        break;
                    case 'exp':
                        descriptionP.textContent = '计算e的x次幂。';
                        break;
                    case 'sqrt':
                        descriptionP.textContent = '计算x的平方根。';
                        break;
                    case 'abs':
                        descriptionP.textContent = '计算x的绝对值。';
                        break;
                    case 'factorial':
                        descriptionP.textContent = '计算x的阶乘。';
                        break;
                    case 'conj':
                        descriptionP.textContent = '计算复数x的共轭。';
                        break;
                    case 'arg':
                        descriptionP.textContent = '计算复数x的辐角（主值）。';
                        break;
                    case 're':
                        descriptionP.textContent = '提取复数x的实部。';
                        break;
                    case 'im':
                        descriptionP.textContent = '提取复数x的虚部。';
                        break;
                    case 'pow':
                        descriptionP.textContent = '执行幂运算。';
                        break;
                    case 'sinh':
                        descriptionP.textContent = '计算x的双曲正弦值。';
                        break;
                    case 'cosh':
                        descriptionP.textContent = '计算x的双曲余弦值。';
                        break;
                    case 'tanh':
                        descriptionP.textContent = '计算x的双曲正切值。';
                        break;
                    default:
                        descriptionP.textContent = '未知函数。';
                }

                const exampleP = document.createElement('p');
                exampleP.className = 'text-xs text-gray-500 mt-1';
                switch (func) {
                    case 'sin':
                        exampleP.textContent = '示例: sin(pi/2) 返回 1';
                        break;
                    case 'cos':
                        exampleP.textContent = '示例: cos(pi) 返回 -1';
                        break;
                    case 'tan':
                        exampleP.textContent = '示例: tan(pi/4) 返回 1';
                        break;
                    case 'asin':
                        exampleP.textContent = '示例: asin(1) 返回 pi/2';
                        break;
                    case 'acos':
                        exampleP.textContent = '示例: acos(-1) 返回 pi';
                        break;
                    case 'atan':
                        exampleP.textContent = '示例: atan(1) 返回 pi/4';
                        break;
                    case 'log':
                        exampleP.textContent = '示例: log(e) 返回 1';
                        break;
                    case 'exp':
                        exampleP.textContent = '示例: exp(1) 返回 e';
                        break;
                    case 'sqrt':
                        exampleP.textContent = '示例: sqrt(4) 返回 2';
                        break;
                    case 'abs':
                        exampleP.textContent = '示例: abs(-5) 返回 5';
                        break;
                    case 'factorial':
                        exampleP.textContent = '示例: factorial(5) 返回 120';
                        break;
                    case 'conj':
                        exampleP.textContent = '示例: conj(2+3i) 返回 2-3i';
                        break;
                    case 'arg':
                        exampleP.textContent = '示例: arg(1+i) 返回 pi/4';
                        break;
                    case 're':
                        exampleP.textContent = '示例: re(2+3i) 返回 2';
                        break;
                    case 'im':
                        exampleP.textContent = '示例: im(2+3i) 返回 3';
                        break;
                    case 'pow':
                        exampleP.textContent = '示例: pow(2, 3) 返回 8';
                        break;
                    case 'sinh':
                        exampleP.textContent = '示例: sinh(0) 返回 0';
                        break;
                    case 'cosh':
                        exampleP.textContent = '示例: cosh(0) 返回 1';
                        break;
                    case 'tanh':
                        exampleP.textContent = '示例: tanh(0) 返回 0';
                        break;
                    default:
                        exampleP.textContent = '暂无示例。';
                }

                descriptionDiv.appendChild(descriptionP);
                descriptionDiv.appendChild(exampleP);

                item.appendChild(funcNameDiv);
                item.appendChild(descriptionDiv);

                basicFunctionsContainer.appendChild(item);
            });
        });
    </script>
</body>
</html>